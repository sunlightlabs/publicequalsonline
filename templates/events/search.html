{% extends "events/base.html" %}
{% load media %}

{% block title %}{{block.super}}Find Local Events{% endblock %}

{% block extrahead %}
{% js "jquery.tablesorter.min.js" %}
<script type="text/javascript">
    $(document).ready(function() {
        $('#events_table').tablesorter({widgets: ['zebra'] });
    });
</script>
{% endblock %}

{% block body %}
<div class="column span-16 last">
	<div id="contentpage">
		<div id="flat_contentpage">
			<h2 class="page_header">Local Events</h2>
			
			<div id="events_content_box">
				<p>Across the nation, bloggers, activists, web developers, technologists and more are coming together to work toward greater government transparency in our city halls, state legislatures and in Washington, D.C. This is the portal to find out where and how you can make government more open. Don’t see an event to attend in your area? Don’t see an activity you’d like to do? <a href="{% url new_event %}">Plan An Event For Your Local Community.</a> Or check back regularly to see what new events will be taking place in your community.
					</p>
					
			<h4 class="subhead_lite">Search for an Event</h4>
			<form id="searchForm" method="GET" action="." name="event_simple_search_form" id="event_simple_search_form">
				<fieldset>
			 {{form.location.label_tag}} {{form.location}}
			<input type="submit" value="Find Events" />
			</fieldset>
			</form>
			</div>


{% if searched %}
<div id="events_results">
<h3>{{search_results|length}} Events Found {% if search_results.geocoded_location %} Near {{search_results.geocoded_location }} {% endif %}</h3>
    <table id="events_table">
        <thead>
            <tr id="titles">
                <th class="table_left sort" id="title_name">Name</th>
                <th class="table_center table_position sort">Location</th>
                <th class="table_right sort">Distance <small>(mi)</small></th>
            </tr>
        </thead>
        <tbody>
            {% for event in search_results %}
            <tr class="{% cycle 'odd' 'even' %}">
                <td class="table_left">
                    <a id="event_name" href="{{ event.get_absolute_url }}">{{event}}</a>
                </td>
                <td class="table_center table_position">{{ event.location }}</td>
                <td class="table_right">{% if event.distance %} {{event.distance.mi|floatformat}} {% endif %}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

		</div>
	</div>
</div>

<div class="column span-8 last">
	<div id="sidebox">
	<h3>Upcoming Events</h3>
		<div id="upcoming_events">
			<ul id="events">
	        {% for event in event_list %}
	        <li>
				<a class="eventTitle" href="{{event.get_absolute_url}}">{{event.title}}</a>
	        {{event.start_date|date:"M d"}}{% if event.end_date %} &ndash; {{ event.end_date|date:"M d" }} {% endif %}
	        {{event.location}}
			</li>
	        {% endfor %}
			</ul>
		</div>
	</div>
</div>



{% endblock %}


