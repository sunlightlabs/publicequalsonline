{% extends "callingtool/base.html" %}
{% load media %}

{% block callingtool %}

	{% if has_called %}
    <div id="thanks_box"><h1 class="header thanks">Thank you for calling your representative in support of the Earmark Transparency Act!</h1>
    <p>
    Could you also take a moment to ask your friends on Facebook and Twitter to call as well using this message: <br />
    It's critical that we know who is influencing our government. Tell Congress to pass the Earmark Transparency Act now <a href="http://snlg.ht/DiscloseNow">http://snlg.ht/DiscloseNow</a>
    <hr />
    </p>
    </div>
	{% else %}
		
		<ol id="step-preview">
			<li><span>Find your representatives.</span></li>
			<li><span>Call their offices.</span></li>
			<li><span>Ask your Representative to cosponsor H.R. 5258, the Earmark Transparency Act, and ask your Senators if theyâ€™ll support S.R. 3335, the Senate version of the Earmark Transparency Act</span></li>
			<li><span>Report the response.</span></li>
		</ol>
		
		<p>Thanks for taking action to make our government more open and accountable!</p>
		<p>The Earmark Transparency Act is a common sense step allowing the American public access to information about how our representatives are requesting and spending government funds for their districts. The bill has been introduced in both the House of Representatives and in the Senate, but Congress needs to hear from all of us to push it through.</p>
		<p>Take a few minutes to call your Representative and Senators now and ask them to co-sponsor the bill. Together, our voices are stronger, so make sure to let us know what they say.</p>
		
	{% endif %}
	
	<p>Please enter your zip code to begin:</p>
	
	<ol id="steps">
		
		<li id="step1" class="step">
			<form action="." method="post" id="stateform">
                <h4><label for="zip">Enter your zip code:</label></h4>
                <input type="text" name="zip" id="zipcode" maxlength="5" size="5" />
				<input type="submit" value="Search">
			</form>
		</li>
		
		<li id="step2" class="step" style="display: none;">
			<h4>Click here for their number</h4>
			<div id="rep-list"></div>
			<div class="clear"></div>
		</li>
		
	</ol>
	
	<div id="loading">
		<img src="{% media_url %}/images/ajax-loader.gif">
	</div>
	
{% endblock %}

{% block scripts %}
	<script>
		$().ready(function() {
			var loading = $('#loading')
			var repList = $('#rep-list');
	        $('#stateform').submit(function() {
	            var value = $('#zipcode').val();
				if (value != '') {
					var url = '/call/state_reps/' + value + '/';
					repList.hide();
					loading.show();
					repList.load(url, null, function() {
						loading.hide();
						repList.show();
						$('#step2').show();
						window.location.hash = value;
					});
	                }
				return false;
			});
			var zipcode = window.location.hash.substr(1);
			if (zipcode) {
				$('#zipcode').val(zipcode);
				$('#stateform').submit();
			}
		});
	</script>
{% endblock %}
