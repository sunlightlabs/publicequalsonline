{% extends "people/base.html" %}
{% load people %}
{% load media %}

{% block title %}Find Campaign Members{% endblock %}

{% block extrahead %}
{% js "jquery.tablesorter.min.js" %}
<script type="text/javascript">
    $(document).ready(function() {
        $('#users_table').tablesorter({headers: {2: {sorter: false} }, widgets: ['zebra'] });
    });
</script>
{% endblock %}

{% block body %}
<script type="text/javascript">
function clickclear(thisfield, defaulttext) {
if (thisfield.value == defaulttext) {
thisfield.value = "";
}
}
function clickrecall(thisfield, defaulttext) {
if (thisfield.value == "") {
thisfield.value = defaulttext;
}
}
</script>

<div class="column span-16">
	<div id="contentpage">
		<div id="flat_contentpage">
		
		<h2 class="page_header">Find Campaign Members</h2>
		<p>The Public=Online Campaign has members across the US. If you are looking to connect with a local group, here's where you'll find them. Or something like that.</p>
		
        	<form id="event_form" method="GET" action=".">
            <ul>
				<li><label for="id_location">Location</label> <input type="text" name="location" id="id_location" value="City, State or Zipcode" onclick="clickclear(this, 'City, State or Zipcode')" onblur="clickrecall(this,'City, State or Zipcode')" /></li>
                <li> {{form.location_range.label_tag}} {{form.location_range}} </li>
				<li><input type="submit" value="Find Campaign Members" class="buttonEvent" /></li>
            </ul>
        </form>  

{% if searched %}
	<div id="events_results">
		<h4 class="goudy">{{search_results|length}} Results {% if search_results.geocoded_location %} Near {{search_results.geocoded_location }} {% endif %}</h4>

        {# i'm quite sorry for this hack to get around the lack of < -james #}
        	{% if search_results.10 %}
        	<div id="users_scroll">
        		{% endif %}
           
		<table id="users_table">
            <thead>
                <tr id="titles">
                    <th class="table_left sort" id="title_name">Name</th>
                    <th class="table_center table_position sort">Position</th>
                    <th class="table_right sort">Distance <small>(mi)</small></th>
                </tr>
            </thead>
            <tbody>
                {% for up in search_results %}
                <tr class="{% cycle 'odd' 'even' %}">
                    <td class="table_left">
                        <a id="user_name" href="{{up.user.get_absolute_url}}">{% display_name up.user %}</a>
                    </td>
                    <td class="table_center table_position">{{up.get_role_display|safe}}</td>
                    <td class="table_right">{% if up.distance %} {{up.distance.mi|floatformat}} {% endif %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if search_results.10 %}
        </div>  
        {% endif %}
    </div>
{% endif %}
		</div>
	</div>
</div>
{% endblock %}

