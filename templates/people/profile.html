{% extends "people/base.html" %}
{% load cache %}
{% load blog %}
{% load people %}
{% load projects %}
{% load media %}

{% block title %}{{block.super}} - {% display_name p_user %}{% endblock %}



{% block body %}

<div class="column span-12">
		<div id="contentpage">

        <div style="border:1px solid #000000;width:64px; height:64px; float:left;">{% gravatar p_user.email %}</div>
		<div style="margin-left:90px;">
            {% if p_user.first_name %}
             	<h3>{{p_user.first_name}}</h3>
            {% else %}
              	<h3>{{p_user.username}}</h3>
            {% endif %}

			{% ifequal user.id p_user.id %}
                <a href="{% url edit_profile %}">(edit profile)</a>
            {% endifequal %}


            {{p_user.profile.get_role_display|safe}}
    		<ul>
				<li>Website: <a class="url" rel="me" href="{{p_user.profile.url|default:"#"}}">{{p_user.profile.url|default:"n/a"}}</a></li>
				<li>Location: {{p_user.profile.location|default:"n/a"}</li>
				<li><p>{{p_user.profile.about}}</p></li>
			</ul>
			</div>


		</div>
</div>


<div class="column span-12 last">
		<div id="contentpage">
<h3>{% possessive p_user %} Projects</h3>
        
                <h4>Lead</h4>
                {% if p_user.projects_lead_on.all %}
                    <ul>
                    {% for project in p_user.projects_lead_on.all %}
                    <li><a class="projectName" href="{{project.get_absolute_url}}">{{project}}</a>

                    {# only show link if user==p_user==project.lead #}
                    {% ifequal user p_user %}
                    {% ifequal user project.lead %}<a class="projectEdit" href="{% url edit_project project.slug %}">edit project</a>{% endifequal %}
                    {% endifequal %}
                    </li>
                    {% endfor %}
                    </ul>
                {% else %}
                    <p>{{p_user.first_name}} hasn't lead any projects just yet.</p>
                {% endif %}
            
                <h4>Helped</h4>
                {% with p_user.project_roles.active.select_related as helped_projects %}
                {% if helped_projects %}
                <ul>
                    {% for r in helped_projects %}
                        <li><a href="{{r.project.get_absolute_url}}">{{r.project}}</a></li>
                    {% endfor %}
                </ul>
                {% else %}
                    <p>{{p_user.first_name}} hasn't helped on any projects just yet.</p>
                {% endif %}
                {% endwith %}
 </div>
</div>           
    
{% endblock %}

